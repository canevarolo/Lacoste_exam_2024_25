Simone Canevarolo
January 24, 2025

COMPUTATIONAL LABORATORY EXAM ON HEAT EXCHANGE

Problem Description
The problem concerns the cross-section of a hollow conductor, with fluid flowing inside and in contact externally with another fluid, both experiencing thermal convection.
Periodically, the initial conditions of the problem are altered: for 30 seconds, a fluid at a lower temperature flows internally, but with the same convective coefficient.
After this period and until the next cycle, lasting 250 seconds, the initial conditions are restored inside the pipes.

Discretization
To solve the problem, one must start from the discretization of the general equation.
Starting from the following partial differential equation formulation, valid for any problem:

ρ cp ∂T/∂t = q + ∂/∂x (k(T) ∂T/∂x) - h As/V (T-Tf)

we can discretize it and obtain the equation:

T_(i+1)^(m+1) (-aa*(1+Δr/(2rr))) + T_i^(m+1) (1+2aa) + T_(i-1)^(m+1) (-aa*(1+Δr/(2*rr))) = T_i^m

with: aa = (kΔt)/(Δr^2ρ*cp)

Periodicity
From the formula for τ (in seconds):

τ = (ρ cp V)/(h As)

For the current case, applying the heat transfer coefficient at the inner radius and using simplifications, we obtain τ = 5850 s, approximately 1 hour 37 minutes.
This means that after this time, the system can be considered to operate in steady periodic conditions, after over 23 cycles. In our code, we consider it effective from the 24th cycle.

Graphs
40 operating cycles were simulated. At t = 5850 s, a vertical line marks the moment the system reaches steady state.
Strong periodic behavior is observed at the inner radius, while temperature variations at the outer radius are significantly smaller.
This confirms the initial hypothesis: due to a heat transfer coefficient differing by two orders of magnitude, the temperature profile of the pipe section at steady state follows an almost logarithmic trend. Consequently, temperature variation at the left edge is much larger than at the right edge during a cycle.

Maximum Temperature at the Outer Radius in Steady-State Operation
The maximum temperature at the outer radius of the metal pipe under steady-state conditions is 319.23793 K.

Numerical Accuracy of the Maximum Temperature
Using a vector with various radial increments, which affects the accuracy of the solution, we obtained the trend of maximum temperature in the system at steady state.

Comparison with a Resin Pipe
In the case of a resin pipe, which has different properties such as lower volumetric density, higher specific heat, and lower thermal conductivity, some differences are observed:

τ is smaller: between 13 and 14 cycles instead of over 23. The system reaches steady state more quickly.

Temperature oscillation at the inner radius is larger, but absolute temperature is lower compared to the metal pipe.

Temperature oscillation at the outer radius is smaller than in the metal pipe, due to the lower thermal conductivity.

Energy Transferred to the Fluid Inside the Conduit
Energy losses per unit length inside the pipe were calculated for a 1-meter length:

Metal pipe: ~2.5 MJ

Resin pipe: ~967 kJ transferred in one hour of steady-state operation

Which Pipe Material to Use?
Based on the study, to minimize heat losses per unit length in the pipe, the thermally optimal model is the resin pipe.
In a hypothetical purchase, many other variables should be considered: cost, availability of materials, and whether it is advantageous compared to metal piping, taking into account possible unforeseen issues or complications.



clear all
close all
clc

%% Punti 1, 2, 3

rin = 1e-2; % m
ss = 5e-2; % m
rout = rin+ss; % m

rovol = 7800; % kg/m^3
cp = 500; % J/kg/K
kk = 25; % W/m/K

Tin = 50+273; % K
Tout = Tin; % K

hout = 20; % W/m^2/K
hin = 2000; % W/m^2/K

tcon = 30; % s
freq = 0.004; % Hz


dr = 1e-4; % m
rr = (rin:dr:rout)';
Nr = length(rr);

dt = 1; % s
tper = 1/freq; % s
nper = 40;
tt = (0:dt:nper*tper);
Nt = length(tt);
timeper = 0; % secondo corrente all'interno del periodo
per = 1; % periodo corrente

Tm = Tin*ones(Nr,1);
Traggioin = Tin*ones(Nt,1);
Traggioout = Tout*ones(Nt,1);

Tmaxright = 0;
Tsave = Tm;

zz = 0;

for ii = 2:Nt

    timeper = timeper+dt;

    aa = kk*dt/dr^2/rovol/cp;
    
    sub_diag = -aa.*(1-dr./2./rr);
    main_diag = (1+2*aa)*ones(Nr,1);
    sup_diag = -aa.*(1+dr./2./rr);

    Band = [[sub_diag(2:end);0], main_diag, [0;sup_diag(1:end-1)]];

    AA = spdiags(Band,-1:1,Nr,Nr);

    bb = Tm; 


    if timeper < 10

        Tin = 50+273; % K

        % Robin

        AA(1,1) = kk/dr+hin;
        AA(1,2) = -kk/dr;
        bb(1) = hin*Tin;
    
        % Robin
    
        AA(end,end-1) = -kk/dr;
        AA(end,end) = kk/dr+hout;
        bb(end) = Tout*hout;


    elseif timeper >= 10 && timeper <= 40

        Tin = 10+273; % K

        % Robin
    
        AA(1,1) = kk/dr+hin;
        AA(1,2) = -kk/dr;
        bb(1) = hin*Tin;
    
        % Robin
    
        AA(end,end-1) = -kk/dr;
        AA(end,end) = kk/dr+hout;
        bb(end) = Tout*hout;

    elseif timeper > 40

        Tin = 50+273; % K

        % Robin

        AA(1,1) = kk/dr+hin;
        AA(1,2) = -kk/dr;
        bb(1) = hin*Tin;
    
        % Robin
    
        AA(end,end-1) = -kk/dr;
        AA(end,end) = kk/dr+hout;
        bb(end) = Tout*hout;

    end


    TT = AA\bb;

    Traggioin(ii) = TT(1);
    Traggioout(ii) = TT(end);

    if timeper == tper

        timeper = 0;
        per = per+1;

    end

    if per > 24
        if Traggioout(ii) > Tmaxright 

            Tmaxright = Traggioout(ii);
            Tsave = TT;

       end

       zz = zz+1;

       if zz <= 3600
    
           qout(zz) = abs(hin*(TT(1)-Tin)*(2*pi*rin));
    
       end

    end


    Tm = TT;

end


tau = rovol*cp/hout*rout/2;
qouttot = sum(qout,'all');



figure(1)
plot(tt,Traggioin-273,'LineWidth',2)
hold on
plot(tt,Traggioout-273,'LineWidth',2)
title('Andamento T nel tempo al raggio interno ed esterno, tubo in metallo')
xlabel('tempo [s]')
ylabel('Temperatura [°C]')
hold on
xline(tau)
legend('T raggio interno', 'T raggio esterno','Tau','Location','best')


fprintf('La temperatura massima al raggio esterno del tubo di metallo in condizioni di regime è %.5f K \n', Tmaxright)


figure(2)
plot(rr,Tsave-273,'LineWidth',2)
title('Profilo temperatura quando T raggio esterno è massima')
xlabel('Lunghezza [m]')
ylabel('Temperatura [°C]')

fprintf('Energia trasferita al condotto interno in una ora di funzionamento con tubatura in metallo: %.5f J \n', qouttot)



%% Punto 4 - accuratezza numerica del valore massimo di temperatura

drvett = sort([5e-3 2e-3 1e-3 5e-4 2e-4 1e-4]);
errmax = zeros(length(drvett),1);

for jj = 1:length(drvett)

    dr = drvett(jj);
    rr = (rin:dr:rout)';
    Nr = length(rr);

    dt = 1; % s
    tper = 1/freq; % s
    nper = 50;
    tt = (0:dt:nper*tper);
    Nt = length(tt);
    timeper = 0; % secondo corrente all'interno del periodo
    per = 1; % periodo corrente

    Tm = Tin*ones(Nr,1);
    Traggioin = Tin*ones(Nt,1);
    Traggioout = Tout*ones(Nt,1);

    Tmax = 0;

    for ii = 2:Nt

        timeper = timeper+dt;

        aa = kk*dt/dr^2/rovol/cp;

        sub_diag = -aa.*(1-dr./2./rr);
        main_diag = (1+2*aa)*ones(Nr,1);
        sup_diag = -aa.*(1+dr./2./rr);

        Band = [[sub_diag(2:end);0], main_diag, [0;sup_diag(1:end-1)]];

        AA = spdiags(Band,-1:1,Nr,Nr);

        bb = Tm; 


        if timeper < 10

            Tin = 50+273; % K

            % Robin

            AA(1,1) = kk/dr+hin;
            AA(1,2) = -kk/dr;
            bb(1) = hin*Tin;

            % Robin

            AA(end,end-1) = -kk/dr;
            AA(end,end) = kk/dr+hout;
            bb(end) = Tout*hout;


        elseif timeper >= 10 && timeper <= 40

            Tin = 10+273; % K

            % Robin

            AA(1,1) = kk/dr+hin;
            AA(1,2) = -kk/dr;
            bb(1) = hin*Tin;

            % Robin

            AA(end,end-1) = -kk/dr;
            AA(end,end) = kk/dr+hout;
            bb(end) = Tout*hout;

        elseif timeper > 40

            Tin = 50+273; % K

            % Robin

            AA(1,1) = kk/dr+hin;
            AA(1,2) = -kk/dr;
            bb(1) = hin*Tin;

            % Robin

            AA(end,end-1) = -kk/dr;
            AA(end,end) = kk/dr+hout;
            bb(end) = Tout*hout;

        end


        TT = AA\bb;


        if timeper == tper

            timeper = 0;
            per = per+1;

        end

        if per > 24
            if max(TT) > Tmax

                Tmax = max(TT);

            end
        end


        Tm = TT;

    end

    Tmaxvett(jj) = Tmax;

end


figure(3)
semilogx(drvett,Tmaxvett,'LineWidth',2)
title('Temperatura massima al variare di dr')
xlabel('dr [m]')
ylabel('Temperatura massima ')
grid on



%% Punto 5 - Tubo in resina


rovol = 1500; % kg/m^3
cp = 1500; % J/kg/K
kk = 5; % W/m/K

dr = 1e-4; % m
rr = (rin:dr:rout)';
Nr = length(rr);

dt = 1; % s
tper = 1/freq; % s
nper = 25;
tt = (0:dt:nper*tper);
Nt = length(tt);
timeper = 0; % secondo corrente all'interno del periodo
per = 1; % periodo corrente

Tm = Tin*ones(Nr,1);
Traggioin = Tin*ones(Nt,1);
Traggioout = Tout*ones(Nt,1);

Tmaxright = 0;
Tsave = Tm;

zz = 0;

for ii = 2:Nt

    timeper = timeper+dt;

    aa = kk*dt/dr^2/rovol/cp;
    
    sub_diag = -aa.*(1-dr./2./rr);
    main_diag = (1+2*aa)*ones(Nr,1);
    sup_diag = -aa.*(1+dr./2./rr);

    Band = [[sub_diag(2:end);0], main_diag, [0;sup_diag(1:end-1)]];

    AA = spdiags(Band,-1:1,Nr,Nr);

    bb = Tm; 


    if timeper < 10

        Tin = 50+273; % K

        % Robin

        AA(1,1) = kk/dr+hin;
        AA(1,2) = -kk/dr;
        bb(1) = hin*Tin;
    
        % Robin
    
        AA(end,end-1) = -kk/dr;
        AA(end,end) = kk/dr+hout;
        bb(end) = Tout*hout;


    elseif timeper >= 10 && timeper <= 40

        Tin = 10+273; % K

        % Robin
    
        AA(1,1) = kk/dr+hin;
        AA(1,2) = -kk/dr;
        bb(1) = hin*Tin;
    
        % Robin
    
        AA(end,end-1) = -kk/dr;
        AA(end,end) = kk/dr+hout;
        bb(end) = Tout*hout;

    elseif timeper > 40

        Tin = 50+273; % K

        % Robin

        AA(1,1) = kk/dr+hin;
        AA(1,2) = -kk/dr;
        bb(1) = hin*Tin;
    
        % Robin
    
        AA(end,end-1) = -kk/dr;
        AA(end,end) = kk/dr+hout;
        bb(end) = Tout*hout;

    end


    TT = AA\bb;

    Traggioin(ii) = TT(1);
    Traggioout(ii) = TT(end);

    if timeper == tper

        timeper = 0;
        per = per+1;

    end

    if per > 14
        if Traggioout(ii) > Tmaxright 

            Tmaxright = Traggioout(ii);
            Tsave = TT;

       end

       zz = zz+1;

       if zz <= 3600
    
           qout_res(zz) = abs(hin*(TT(1)-Tin)*(2*pi*rin));
    
       end

    end


    Tm = TT;

end


tau_res = rovol*cp/hout*rout/2;
qouttot_res = sum(qout_res,'all');



figure(4)
plot(tt,Traggioin-273,'LineWidth',2)
hold on
plot(tt,Traggioout-273,'LineWidth',2)
title('Andamento T nel tempo al raggio interno ed esterno, tubo in resina')
xlabel('tempo [s]')
ylabel('Temperatura [°C]')
hold on
xline(tau_res)
legend('T raggio interno', 'T raggio esterno','Tau','Location','best')


fprintf('Energia trasferita al condotto interno in una ora di funzionamento con tubatura in resina: %.5f J', qouttot_res)


